<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <h:form>  
            <p:growl id="growl" life="6000" globalOnly="true"/>
            <p:menubar>
                <p:submenu label="Home">
                </p:submenu>
                <p:submenu label="Plan">
                </p:submenu>
                <f:facet name="options">
                    <p:inputText style="margin:1px 10px 1px 1px;" placeholder="Search"/>
                    <!--<p:commandButton action="#{studentMBeans.redirect()}" value="signup"></p:commandButton>-->
                    <p:commandButton action="#{officeMBean.redirect2()}" value="logout"></p:commandButton>
                </f:facet>
            </p:menubar>
        </h:form>

        <h:form id="uploadForm" enctype="multipart/form-data">
            <h:panelGrid columns="2">
                <!--when we add mode to  simple or advance but advance mode only we can allow ajax features of allotypes,sizelimitetc-->
                <!--allotypes  property restrict the file type to be specific-->
                <p:fileUpload id="file"  fileUploadListener="#{profileManageBean.profileImageUploadHandler1}"
                              mode="advanced" 
                              update="messages"
                              sizeLimit="10000000" 
                              allowTypes="/(\.|\/)(gif|jpe?g|png)$/" required="true" />
                <p:growl id="messages" showDetail="true"/>
            </h:panelGrid>

            <h:outputText value="&#160;" />
            <h:outputText value="&#160;" />

            <!--this is the datatable of profile-->

            <!--display the list of user in the same page by extracting from db-->
            <div class="card">
                <p:dataTable id="count" value="#{profileManageBean.filePath}" var="p">
                    <p:column>
                        <p:graphicImage style="width:10%;" alt="imag" value="/getImage/#{p.profileName}">
                        </p:graphicImage>
                    </p:column>
                    <p:column headerText="View">
                        <!--here we call the method triggerdialog from managed bean to hold the data in the string fileName that will eventually will be displayed in the dialog form-->
                        <p:commandButton update="uploadForm,dialog2" value="view" oncomplete="PF('dialogform').show()" action="#{profileManageBean.triggerdialog(p)}" ></p:commandButton>
                    </p:column>
                 
                </p:dataTable>
                <p:spacer height="20px"></p:spacer>  
            </div>
        </h:form>
        <p:dialog widgetVar="dialogform" id="dialog2"
                  header="addProfile"
                  closable="true" 
                  modal="true" 
                  showEffect="fade" 
                  closeOnEscape="true" hideEffect="fade" 
                  resizable="false">
            <h:form id="formOne">
                <p:graphicImage style="width:50%;" alt="imag" value="/getImage/#{profileManageBean.fileName}">
                </p:graphicImage>
                <p:panelGrid columns="2" id="panel2">
                    <p:commandButton oncomplete="PF('dialogform').hide();" ajax="false"  value="Download" icon="pi pi-arrow-down" styleClass="ui-button-outlined">
                        <p:fileDownload value="#{profileManageBean.downloadFile}"/>
                    </p:commandButton>
                </p:panelGrid>
            </h:form>
        </p:dialog>

    </h:body>
</html>

